{% load wagtailcore_tags %}

<div id="resource_{{page.id}}" class="resource">
  <div class="br1 shadow-2 tl w-60-ns center">
    <div class="ph3 pt2 pb0 pt3-ns ph4-ns mt4">
      <h2 class="mt0 mb1 resource_title"><a class="link link-hover" href="/{{page.parent}}/{{page.slug}}/">{{ page.heading }}</a></h2>
      <div class="word-wrap">
        {% if page.resource_url %}
          <a target="_blank" class="f6 lm-turquoise resource-link link-hover link-visited pv1" href="{{ page.resource_url }}">
            {% if page.resource_url_text %}
              {{ page.resource_url_text }}
            {% else %}
              {{ page.resource_url }}
            {% endif %}
          </a>
        {% endif %}
      </div>
      {% if page.video %}
        <div class="tc ma2">
          {{ page.video }}
        </div>
      {% endif %}
    </div>
    <div class="pv4 pb4-ns pt3-ns">
      {% if page.pros %}
        <div class="tc db dn-ns">
          {% include "resources/secondary_button.html" with value="View pros and cons" background="light" class="view_pcs" id="view_pcs{{@page.id}}" %}
        </div>
      {% endif %}
      <div class="w-100 dn dt-ns db-ns pros_cons bb b--lm-grey pb3" id="pros_cons{{page.id}}">
        <div class="ph4-ns ph3 w-50-ns dib-ns dtc-ns br-ns b--lm-grey pros">
          {{page.pros|richtext}}
        </div>
        <div class="ph4-ns ph3 w-50-ns dib-ns dtc-ns">
          {{page.cons|richtext}}
        </div>
      </div>
      <div class="dt pt3">
        <div class="ph4-ns ph3 w-50-ns dib-ns dtc-ns br-ns bb bb-0-ns mb2 mb0-ns b1 v-top b--lm-grey">
          <h4 class="nunito-bold mt0">Would you recommend this?</h4>
          <div class="dt dt--fixed">
            <div class="dib dtc">
              <div class="dib mb3 v-mid tl"><span>{{page.number_of_likes|default:0}}</span></div>
              <form action="/like/" method="post" class="dib pointer like-form">
                <button type="submit" class="{% if page.liked_value == 1 %}liked{% endif %} like resource-like w2 h2 bn bg-white fl p0 bg-left pointer" data-url="{{page.resource_url}}"><span class="fixed o-0">Recommend</span></button>
                <input type="hidden" name="id" value="{{page.id}}"/>
                <input type="hidden" name="like" value="1"/>
                {% csrf_token %}
              </form>
              <form action="/like/" method="post" class="dib pointer dislike-form">
                <button name="dislike" type="submit" class="{% if page.liked_value == -1 %}disliked{% endif %} dislike resource-dislike w2 h2 bn bg-white p0 bg-right pointer" data-url="{{page.resource_url}}"><span class="fixed o-0">Don't Recommend</span></button>
                <input type="hidden" name="id" value="{{page.id}}"/>
                <input type="hidden" name="like" value="-1"/>
                {% csrf_token %}
              </form>
              <div class="dib mb3 v-mid tl"><span>{{page.number_of_dislikes|default:0}}</span></div>
            </div>
          </div>
          {% if page.liked_value == 1 or page.liked_value == -1 %}
          {% if like_feedback_submitted %}
          <div class="alert ma0 mb1 mr1 mt4 pa3 ba bw1-ns bg--lm-green b--lm-green relative">
            Suggestions submitted successfully!
            <i class="bg--lm-dark-green lm-white absolute br-100 fa fa-check lm-flash-icon lm-tick-icon"></i>
          </div>
          {% else %}
          <form class="like-form resource-feedback">
            {% csrf_token %}
            <input type="hidden" name="id" value="{{page.id}}" />
            <p>
              Why {% if page.liked_value == 1 %}would you{% else %}wouldn't you{% endif %} recommend this?
            </p>
            <label for="id_{{page.id}}" class="dn"></label>
            <textarea id="id_{{page.id}}" name="feedback" class="h3 f5 w-100 pa2 nr b--lm-grey"></textarea>
            <div class="dib w-100">
              <button class="f5 link dib ph3 pv2 br1 pointer nunito tracked inner-shadow-active lm-white lm-bg-dark-blue button lm-bg-orange-hover lm-dark-blue-hover bottom--1 mt2 fr">Submit</button>
            </div>
            <input type="hidden" name="resource_title" value="{{page.title}}" />
            <input type="hidden" name="liked" value="{{page.liked_value}}" />
            <input type="hidden" name="resource_name" value="{{page.heading}}" />
          </form>
          {% endif %}
          {% endif %}
        </div>
        <div class="dib-ns dtc-ns ph4-ns ph3">
          <h4 class="nunito-bold mt0">Get more info</h4>
          <p>
            Find out more about this tool, read reviews and discuss with other users.
          </p>
          <button class="f6 link dib ph3 pv2 br1 pointer nunito tracked inner-shadow-active lm-white lm-bg-dark-blue button lm-bg-orange-hover lm-dark-blue-hover">
            <a class="link" href="/{{page.parent}}/{{page.slug}}/">read reviews and join the discussion</a>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
